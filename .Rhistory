setwd("/Users/colin/Documents/Code/RepoRes/Assignment1/RepData_PeerAssessment1")
Adata <- read.csv("activity.csv")
Adata$date <- as.Date(Adata$date, "%Y-%m-%d")
hist(Adata$steps)
mean(Adata$steps)
useData <- subset(Adata, !is.na(steps))
mean(useData$steps)
median(useData$steps)
avgedSteps <- aggregate(steps ~ date, FUN="mean")
avgedSteps <- aggregate(steps ~ date,data=useData, FUN="mean")
head(avgedSteps)
avgedStepsByInterval <- aggregate(steps ~ interval,data=useData, FUN="mean")
with(avgedStepsByInterval, plot(steps, interval, type="l"))
mSteps <- max(avgedStepsByInterval$steps)
mSteps
subset(avgedStepsByInterval, steps=mSteps)
subset(avgedStepsByInterval, steps==mSteps)
for (i in 1:nrow(Adata)) {
ii <- Adata[i,]
if (is.na(ii[1,1])) {
sst <- avgedSteps[avgedSteps$date == ii[1,2], 2]
if (length(sst)>0) {
rii <- list(steps=avgedSteps[avgedSteps$date == ii[1,2], 2], date=ii[1,2], interval=ii[1,3])
} else {
rii <- list(steps=0, date=ii[1,2], interval=ii[1,3])
}
} else {
rii <- ii
}
if (start==TRUE) {
store1 <- data.frame(rii)
names(store1) <- names(Adata)
start <- FALSE
} else {
store1 <- rbind(store1, rii)
}
}
start = TRUE
for (i in 1:nrow(Adata)) {
ii <- Adata[i,]
if (is.na(ii[1,1])) {
sst <- avgedSteps[avgedSteps$date == ii[1,2], 2]
if (length(sst)>0) {
rii <- list(steps=avgedSteps[avgedSteps$date == ii[1,2], 2], date=ii[1,2], interval=ii[1,3])
} else {
rii <- list(steps=0, date=ii[1,2], interval=ii[1,3])
}
} else {
rii <- ii
}
if (start==TRUE) {
store1 <- data.frame(rii)
names(store1) <- names(Adata)
start <- FALSE
} else {
store1 <- rbind(store1, rii)
}
}
head(store1)
head(store1, 100)
head(store1[200, 300])
head(store1[200:300,])
head(store1[1200:1300,])
length(subset(Adata, is.na(steps)))
head(Adata)
nrows(subset(Adata, is.na(steps)))
nrow(subset(Adata, is.na(steps)))
mean(store1$steps)
median(store1$steps)
hist(Adata$steps)
totSteps <- Aggregate(steps ~ interval, data=useData, FUN=sum)
totSteps <- aggregate(steps ~ date, data=useData, FUN="sum")
hist(totSteps)
hist(totSteps$Steps)
hist(totSteps$steps)
head(totSteps)
mean(totSteps$steps)
median(totSteps$steps)
totStepsAdj <- aggregate(steps ~ date, data=store1, FUN="sum")
hist(totStepsAdj$steps)
mean(totStepsAdj$steps)
median(totStepsAdj$steps)
gl(7,1 )
factor(1:7, c(1,1,1,1,2,2,2))
tt <- factor(weekdays(store1$date), c("weekday", "weekend"))
head(tt)
tt <- factor(store1$date, c("weekday", "weekend"))
head(tt)
gg <- function(aDay) {
if (weekdays(aDay) %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) {}
}
gg <- function(aDay) {
if (weekdays(aDay) %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) {
"weekday"
} else {
"weekend"
}
}
tts <- sapply(useData$date, FUN=gg)
head(tts)
ttsf <- factor(tts)
str(ttsf)
tts <- sapply(store1$date, FUN=gg)
ttsf <- factor(tts)
store1$ext <- ttsf
head(store1)
par(mfrow=c(2))
par(mfrow=c(2,1))
par(mfrow=c(2,1))
with(store1, plot(interval, steps, type="n"))
with(subset(store1, ext="weekday"), lines(interval, steps))
with(store1, plot(interval, steps))
with(subset(store1, ext="weekday"), plot(interval, steps, type="l"))
with(subset(store1, ext="weekend"), plot(interval, steps, type="l"))
with(aggregate(steps ~ interval, data=subset(store1, ext="weekday"), Fun="mean"), plot(interval, steps, type="l"))
with(aggregate(steps ~ interval, data=subset(store1, ext="weekday"), FUN="mean"), plot(interval, steps, type="l"))
with(aggregate(steps ~ interval, data=subset(store1, ext="weekend"), FUN="mean"), plot(interval, steps, type="l"))
with(aggregate(steps ~ interval, data=subset(store1, ext="weekend"), FUN="mean"), plot(interval, steps, type="l"))
sst <- subset(store1, ext="weekend")
head(sst)
with(aggregate(steps ~ interval, data=subset(store1, ext=="weekend"), FUN="mean"), plot(interval, steps, type="l"))
with(aggregate(steps ~ interval, data=subset(store1, ext=="weekday"), FUN="mean"), plot(interval, steps, type="l"))
with(aggregate(steps ~ interval, data=subset(store1, ext=="weekend"), FUN="mean"), plot(interval, steps, type="l"))
